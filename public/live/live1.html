<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>直播页面</title>
</head>
<body>
    <link rel="stylesheet" type="text/css" href="style.css">
   <script src="flv.min.js"></script>
   <script src="../gethead.js"></script>
   <div id="header"></div>
   <br><br><br>
   <h1 style="text-align: center;">朝外2022级学生会直播平台</h1>
   <br>
   <center>
    <div id="but" method="POST">
        <form>请输入推流码: <input id="code" type="text"></form>
        <button class="button" id="button" onclick="playflv()"><b>观看直播</b></button>
    </div>
   </center>
   <br>
   <video id="videoElement" style="display: block; margin: auto; border-radius: 15px;" width="60%" controls></video>
   <script>
    function playflv(){
        document.getElementById('but').style.visibility='hidden';
        var code=document.getElementById('code').value;
        console.log(code);
        if (flvjs.isSupported()) {
           var videoElement = document.getElementById('videoElement');
           var flvPlayer = flvjs.createPlayer({
               type: 'flv',
               url: `http://cyxsh.top:8001/live/${code}.flv`
           });
           flvPlayer.attachMediaElement(videoElement);
           flvPlayer.load();
           flvPlayer.play();
       }
    }  
   </script>
   <iframe src="message.html" frameborder="0" class="message"></iframe>
</body>
</html>